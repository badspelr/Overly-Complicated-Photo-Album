# Photo Album TODO List

## High Priority

## Medium Priority
- Fix slideshow
- Create Android app as frontend for photo album (native app with Django REST API backend for mobile photo browsing, AI search, camera integration, and offline access)

## Low Priority

SECURITY FIX COMPLETED: Fixed major security vulnerability where users could assign themselves admin privileges
- Created separate forms: CustomUserChangeForm (basic profile) vs AdminUserChangeForm (with groups)  
- UserUpdateView now only allows basic profile editing (no group management)
- UserEditView uses appropriate form based on admin level
- Fixed users without group assignments - all non-superusers now have Viewer group

PERMISSION SYSTEM REDESIGN COMPLETED: Fixed album admin privilege escalation
- PROBLEM: Global "Album Admin" group gave users admin rights to ALL albums (User B could admin User A's albums)
- SOLUTION: Eliminated global Album Admin group, now using per-album ownership model
- Album owners are automatically admins of ONLY their own albums
- Removed AlbumAdminUsersView and album_admin_users URL
- Updated middleware to use is_album_owner instead of is_album_admin
- Updated all permission checks to use album.owner or is_album_admin(user, album)
- Removed all users from Album Admin group - now using owner field for permissions

ACCOUNT DELETION FEATURE COMPLETED: Users can now delete their accounts and all data
- Added AccountDeleteView with proper permission checks (users can only delete own account)
- Created delete_account.html template with data summary and warnings
- Shows count of albums, photos, videos, tags, and custom albums that will be deleted
- Requires explicit confirmation checkbox and double confirmation dialog
- CASCADE deletion automatically removes all user's data: albums, photos, videos, tags, custom albums, share links, favorites
- Added "Danger Zone" section to profile page with delete account link
- GDPR compliant - complete data removal upon account deletion

## Completed
- ✅ **Celery production validation checklist** - Created comprehensive CELERY_PRODUCTION_VALIDATION.md with 8 validation tests, monitoring procedures, troubleshooting guide, and sign-off checklist to verify Celery workers ready for production deployment
- ✅ **Terms of Conduct and CSAM Policy** - Created TERMS_OF_CONDUCT.md (18 sections: acceptable use, content ownership, privacy/GDPR, moderation, termination) and CSAM_POLICY.md (zero tolerance, detection mechanisms, 1-hour response, NCMEC reporting, law enforcement cooperation); both production-ready with customization notes
- ✅ **Documentation consolidation** - Merged related docs: DOCKER_GUIDE.md + DOCKER_RESOURCE_GUIDE.md → DOCKER.md (comprehensive 600+ line guide); CELERY_SETUP.md + CELERY_QUICKREF.md → CELERY.md (complete Celery guide); All technical notes → IMPLEMENTATION_NOTES.md (consolidated change history); Updated documentation indexes and quick reference; Total reduction: 20 files → 13 files (35% reduction)
- ✅ **Documentation reorganization** - Moved all documentation from root to organized `docs/` directory structure with categories: getting-started, user-guides, admin-guides, deployment, technical; created comprehensive docs/README.md index with navigation; created professional README.md for root; reduced root clutter from 17 MD files to just README.md and CHANGELOG.md
- ✅ **Review all documentation and update as needed** - Updated CHANGELOG.md with v1.2.0 release notes (AI Settings, Cookie Consent, Comprehensive User Manual, About/Contact pages); Enhanced OVERVIEW.md with new Administrative Features section, GDPR compliance, and Documentation & Help section; Added note to USER_MANUAL.md directing users to HTML version at /user-manual/
- ✅ **Comprehensive User Manual** - Expanded in-app user manual from 99 lines to 991 lines with 15 detailed sections: Getting Started, Account Management, Albums, Photos/Videos, Categories/Tags, Search, AI Features, Sharing, Custom Albums, Favorites, Bulk Actions, Keyboard Shortcuts, Admin Features, Mobile Tips, Troubleshooting; includes quick navigation menu, visual styling, and step-by-step guides
- ✅ **Cookie Consent System** - Implemented GDPR-compliant cookie consent with banner (localStorage-based for reliability), detailed policy page at /cookie-policy/ with cookie tables, Accept All and Essential Only options, footer link on all pages; fixed persistence bug by switching from document.cookie to localStorage
- ✅ **AI Settings Admin Interface** - Created web-based AI configuration at /ai-settings/ for admin users; form-based management of auto-processing, scheduled processing, batch sizes, timeouts; real-time settings updates without code deployment; hardware optimization options
- ✅ **About and Contact Pages** - Added /about/ page with feature list and mission statement, /contact/ form with pre-filled user data and email notifications to admins, footer navigation links on all pages
- ✅ **Implemented automatic AI processing with Celery** - Added background task queue for AI photo/video analysis; processing happens automatically on upload (configurable); scheduled batch processing at 2 AM daily for 500 photos; added processing_status field to track progress; integrated with existing process_photos_ai/process_videos_ai commands; configurable via settings (auto-process on upload, scheduled processing, batch size, timeout); ready for production deployment with Celery worker and Beat scheduler
- ✅ Added sticky bottom bulk action bar - slides up from bottom when photos selected, always accessible without scrolling; includes Download, Delete, Category selector, and Tags input; shows selection count and clear button; mobile responsive with full-width stacked layout
- ✅ Improved bulk action controls styling - organized category and tag inputs with labels, icons, and consistent styling; added bordered container, better spacing, mobile-responsive layout that stacks vertically on small screens
- ✅ Fixed photo/video detail navigation with invalid filter values - added validation to skip 'all' values and handle non-numeric IDs gracefully when parsing category/album filters from return URLs
- ✅ Added photo slideshow feature with category filtering - full-screen slideshow with play/pause, navigation, speed control (2s/3s/5s/10s), progress bar, keyboard shortcuts (Space=pause, Arrows=nav, F=fullscreen, Esc=exit), automatically filters to show only photos (not videos) from current view/category
- ✅ Added Custom Albums documentation to USER_MANUAL.md and user_manual.html - explained virtual collections feature, how to create/use custom albums, difference from regular albums, and example use cases
- ✅ Added ability to edit date taken/recorded metadata - PhotoForm and VideoForm now include date_taken/date_recorded fields with datetime-local input widgets, plus camera metadata (make, model) and location (latitude, longitude) for photos
- ✅ Fixed MOV video upload rejection due to MIME type detection issues
- ✅ Fixed 541 broken photo/video references causing album crashes  
- ✅ Restored AI photo analysis features with local BLIP models for GPU-accelerated image captioning
- ✅ Fixed search functionality on album pages (array-based tag search and permission issues)
- ✅ Enhanced Django admin panel with comprehensive model registration
- ✅ Cleaned up code syntax errors and unused imports with pyflakes/autoflake
- ✅ Verified album sharing and invitation system works with search permissions
- ✅ Fixed FileNotFoundError in search page by removing 5 orphaned photo records with missing files
- ✅ Added missing web interface for photo AI processing (http://127.0.0.1:8001/process-photos-ai/) - now photos and videos both have web UI
- ✅ Fixed superuser search permissions - superusers can now search any album (was missing from permission checks)
- ✅ Fixed AI photo processing page showing 96 "pending" photos that were actually orphaned database records with missing files - added orphaned record detection and cleanup functionality
- ✅ Fixed AI video processing page with same improvements as photos: orphaned record detection/cleanup, modern dark theme design, processing progress modal with user feedback
- ✅ Fixed inconsistent permissions for AI processing pages - both photos and videos now require album admin or superuser access (was: videos=superuser only, photos=any user)
- ✅ Updated all documentation to reflect new AI processing features: USER_MANUAL.md AI section rewritten, AI_COMMANDS_REFERENCE.md updated with local BLIP info and web interfaces, MANAGEMENT_COMMANDS.md enhanced, OVERVIEW.md feature highlights updated, INSTALL.md AI setup instructions revised
- ✅ Fixed inconsistent AI search behavior across pages - albums page now searches both album metadata AND media content using AI descriptions/tags, matching the individual album page search functionality
- ✅ Fixed checkboxes on profile and edit users page - improved alignment, spacing, and visual consistency with proper CSS styling instead of inline styles
- ✅ Fixed pagination after search navigation - photo/video detail views now maintain search context for left/right navigation arrows, showing next/previous items from search results instead of full album
- ✅ Added About and Contact pages with footer navigation - created /about/ page with features list and mission statement, /contact/ page with email form, footer appears on all pages except album detail, responsive design with dark theme
- ✅ Fixed photo edit permission error - album owners can now edit photos in their albums (was only allowing superusers due to broken permission check)
- ✅ Fixed empty category dropdown - now shows all user-accessible categories instead of only assigned ones, allowing bulk category assignment
- ✅ Fixed invisible dropdown options in dark theme - select option elements now have explicit background/text colors for visibility
- ✅ Added "Invite User" link for album owners - cleaned up obsolete navigation code, album owners now see proper invite link in sidebar
- ✅ Fixed album owner permissions across the system - updated invite_user, dashboard display, AI processing, and user deletion to properly recognize is_album_owner instead of obsolete is_album_admin
- ✅ Sorting features fully implemented - album pages have 6 sort options (date taken/added newest/oldest, title A-Z/Z-A), global search has 7 sort fields (date, title, width, height, duration, file size) with independent direction control, all sorting works with filters and pagination
- ✅ Complete AI processing admin interface - created /ai-settings/ page for configuring auto-processing, scheduled processing, batch size, and timeouts; added navigation links for site admins; AIProcessingSettings singleton model with form-based management; manual trigger buttons already existed at /process-photos-ai/ and /process-videos-ai/
- ✅ Comprehensive user manual - created detailed 15-section user manual (1000+ lines) covering all features: getting started, account management, albums, photos/videos, categories/tags, search, AI features, sharing, custom albums, favorites, bulk actions, keyboard shortcuts, admin features, mobile features, and troubleshooting; includes quick navigation, visual styling, step-by-step guides, and real-world examples
- ✅ Cookie compliance (GDPR) - implemented cookie consent banner with Accept/Essential Only options; created comprehensive cookie policy page at /cookie-policy/ with detailed cookie table (types, purposes, durations); added cookie link to footer; banner auto-shows on first visit and respects user preferences; stores consent in cookie for 1 year; mobile responsive design; complies with GDPR requirements for transparency and user control
